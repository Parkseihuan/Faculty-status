<!DOCTYPE html>
<html>
<head>
  <base target="_top">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>êµì› í˜„í™©í‘œ</title>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Noto Sans KR', 'Malgun Gothic', 'Apple SD Gothic Neo', sans-serif;
      padding: 10px;
      background-color: #f5f7fa;
      overflow-x: auto;
      color: #2c3e50;
    }
    
    .container {
      max-width: 100%;
      margin: 0 auto;
      background-color: white;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
      overflow: hidden;
    }
    
    .header {
      margin-bottom: 20px;
      text-align: center;
    }
    
    .controls {
      margin-bottom: 15px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 12px;
      background-color: #f8f9fa;
      border-radius: 4px;
      border: 1px solid #dee2e6;
    }

    .controls-left {
      display: flex;
      gap: 10px;
    }

    .controls-right {
      display: flex;
      gap: 10px;
    }
    
    .btn {
      padding: 8px 16px;
      background-color: #007bff;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 13px;
      margin-left: 8px;
      font-weight: 500;
      transition: all 0.2s;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    
    .btn:hover {
      background-color: #0056b3;
      transform: translateY(-1px);
      box-shadow: 0 4px 8px rgba(0,0,0,0.15);
    }
    
    .btn:active {
      transform: translateY(0);
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    
    /* í…Œì´ë¸” ì»¨í…Œì´ë„ˆ ìŠ¤íƒ€ì¼ ê°œì„  */
    .table-container {
      overflow: auto;
      margin-top: 15px;
      width: 100%;
      max-width: 100%;
      padding-bottom: 10px;
      height: 70vh;
      border: 1px solid #dee2e6;
      border-radius: 4px;
      position: relative;
      -webkit-overflow-scrolling: touch;
      background-color: #ffffff;
      /* ìŠ¤í¬ë¡¤ë°” ìŠ¤íƒ€ì¼ */
      scrollbar-width: thin;
      scrollbar-color: #adb5bd #f8f9fa;
    }
    
    /* ì›¹í‚· ë¸Œë¼ìš°ì €ìš© ìŠ¤í¬ë¡¤ë°” ìŠ¤íƒ€ì¼ */
    .table-container::-webkit-scrollbar {
      width: 12px;
      height: 12px;
    }
    
    .table-container::-webkit-scrollbar-track {
      background: #f8f9fa;
      border-radius: 4px;
    }
    
    .table-container::-webkit-scrollbar-thumb {
      background: #adb5bd;
      border-radius: 4px;
    }
    
    .table-container::-webkit-scrollbar-thumb:hover {
      background: #6c757d;
    }
    
    /* í…Œì´ë¸” ë ˆì´ì•„ì›ƒ ê³ ì • */
    table {
      width: 3095px !important;
      border-collapse: collapse;
      font-size: 11px;
      table-layout: fixed !important;
      position: relative;
      background-color: white;
    }
    
    /* thead ê³ ì • */
    thead {
      position: sticky;
      position: -webkit-sticky;
      top: 0;
      z-index: 100;
    }
    
    /* ëª¨ë“  ì…€ ê¸°ë³¸ ìŠ¤íƒ€ì¼ */
    th, td {
      border: 1px solid #d3d3d3;
      padding: 4px 6px;
      text-align: center;
      vertical-align: middle;
      overflow: hidden;
      background-color: white;
      position: relative;
    }
    
    /* í—¤ë” ìŠ¤íƒ€ì¼ */
    th {
      background-color: #f5f7fa !important;
      font-weight: bold;
      white-space: nowrap;
      font-size: 12px;
      letter-spacing: 0.5px;
      border: 1px solid #c8ced3;
      color: #2c3e50;
    }

    /* ===== ê³ ì • ì—´ ìŠ¤íƒ€ì¼ ìµœì¢… ë²„ì „ ===== */
    
    /* ëª¨ë“  ì²« ë²ˆì§¸ ìì‹ ìš”ì†Œ ê³ ì • */
    tr > *:first-child {
      position: -webkit-sticky !important;
      position: sticky !important;
      left: 0 !important;
      z-index: 10 !important;
      background-color: #f8f9fa !important;
      width: 30px !important;
      min-width: 30px !important;
      max-width: 30px !important;
    }
    
    /* ëª¨ë“  ë‘ ë²ˆì§¸ ìì‹ ìš”ì†Œ ê³ ì • (rowspanì´ ì—†ëŠ” í–‰ì—ì„œ) */
    tr:not(:has(td[rowspan])) > *:nth-child(2),
    tr:has(td[rowspan]) > td.dept-name {
      position: -webkit-sticky !important;
      position: sticky !important;
      left: 30px !important;
      z-index: 9 !important;
      background-color: #f8f9fa !important;
      width: 85px !important;
      min-width: 85px !important;
      max-width: 85px !important;
    }
    
    /* colspan="2"ì¸ ê²½ìš° */
    tr > *[colspan="2"] {
      position: -webkit-sticky !important;
      position: sticky !important;
      left: 0 !important;
      z-index: 10 !important;
      background-color: #f8f9fa !important;
      width: 115px !important;
      min-width: 115px !important;
      max-width: 115px !important;
    }
    
    /* í—¤ë”ì˜ ê³ ì • ì—´ */
    thead tr > *:first-child,
    thead tr > *:nth-child(2),
    thead tr > *[colspan="2"] {
      z-index: 150 !important;
      background-color: #34495e !important;
      color: white !important;
      position: -webkit-sticky !important;
      position: sticky !important;
      top: 0 !important;
    }
    
    /* ê³ ì • ì—´ í…Œë‘ë¦¬ */
    tr > *:first-child,
    tr > *:nth-child(2),
    tr > *[colspan="2"] {
      border-right: 3px solid #343a40 !important;
      box-shadow: 3px 0 8px rgba(0,0,0,0.1) !important;
    }
    
    /* dept-vertical íŠ¹ë³„ ì²˜ë¦¬ */
    td.dept-vertical {
      position: -webkit-sticky !important;
      position: sticky !important;
      left: 0 !important;
      z-index: 11 !important;
      background-color: #f8f9fa !important;
    }
    
    /* 4. í—¤ë”ì˜ íŠ¹ì • ë°°ê²½ìƒ‰ */
    thead th.full-time-header {
      background-color: #e8f1ff !important;
      color: #1a73e8;
    }
    
    thead th.part-time-header {
      background-color: #e8f5e9 !important;
      color: #137333;
    }
    
    /* 5. ì†Œê³„/í•©ê³„ ë°°ê²½ìƒ‰ */
    .subtotal-full, tbody td.subtotal-full, thead th.subtotal-full {
      background-color: #cce5ff !important;
      color: #004085;
      font-weight: bold;
    }
    
    .subtotal-part, tbody td.subtotal-part, thead th.subtotal-part {
      background-color: #d4edda !important;
      color: #155724;
      font-weight: bold;
    }
    
    .grand-total, tbody td.grand-total, thead th.grand-total {
      background-color: #fff3cd !important;
      color: #856404;
      font-weight: bold;
    }
    
    /* ê¸°íƒ€ ì§ê¸‰ í—¤ë” ë°°ê²½ìƒ‰ */
    .other-header {
      background-color: #ffeaa7 !important;
      color: #744210;
    }
    
    /* 6. í•©ê³„ í–‰ ë°°ê²½ìƒ‰ */
    .total-row {
      background-color: #f8f9fa;
    }
    
    .total-row td {
      background-color: #f8f9fa !important;
      font-weight: bold;
      border-top: 2px solid #495057;
    }
    
    /* 7. ë°ì´í„° ì…€ì€ ëª¨ë‘ í°ìƒ‰ (ê°•ì œ) */
    tbody td.names-cell,
    tbody td.position-cell {
      background-color: white !important;
    }
    
    /* ì†Œê³„ì™€ í•©ê³„ ì…€ì˜ íŒ¨ë”© ì˜¤ë²„ë¼ì´ë“œ */
    td.subtotal-full, td.subtotal-part, td.grand-total,
    th.subtotal-full, th.subtotal-part, th.grand-total {
      padding: 0 !important;
      overflow: visible !important;
    }
    
    .dept-header {
      background-color: #f8f9fa;
      font-weight: bold;
      font-size: 12px;
      color: #2c3e50;
      border: 1px solid #dee2e6;
    }
    
    /* ì²« ë²ˆì§¸ ì—´ì˜ dept-headerëŠ” í•­ìƒ ê³ ì • */
    td.dept-header:first-child,
    td.dept-header[colspan="2"] {
      position: -webkit-sticky !important;
      position: sticky !important;
      left: 0 !important;
      z-index: 10 !important;
    }
    
    .dept-vertical {
      writing-mode: vertical-rl;
      text-orientation: mixed;
      height: 150px;
      vertical-align: middle;
      width: var(--dept-vertical-width) !important;
      min-width: var(--dept-vertical-width) !important;
      max-width: var(--dept-vertical-width) !important;
      padding: 4px !important;
      font-size: 12px;
      line-height: 1.2;
      letter-spacing: 0.5px;
    }
    
    .dept-header:not(.dept-vertical) {
      width: 80px !important;
      min-width: 80px !important;
      max-width: 80px !important;
    }
    
    /* CSS ë³€ìˆ˜ë¥¼ ì‚¬ìš©í•œ ì—´ ë„ˆë¹„ ì •ì˜ */
    :root {
      --dept-vertical-width: 30px;
      --dept-name-width: 85px;
      --position-width: 160px;
      --subtotal-width: 30px;
      --total-width: 40px;
    }
    
    /* ê³ ì • ì—´ ë„ˆë¹„ ê°•ì œ ì„¤ì • */
    /* ì²« ë²ˆì§¸ ì—´ */
    thead th:first-child,
    tbody td:first-child,
    .sticky-col-1 {
      width: 30px !important;
      min-width: 30px !important;
      max-width: 30px !important;
    }
    
    /* ë‘ ë²ˆì§¸ ì—´ */
    thead th:nth-child(2),
    tbody td:nth-child(2):not([colspan]),
    .sticky-col-2 {
      width: 85px !important;
      min-width: 85px !important;
      max-width: 85px !important;
    }
    
    /* colspan="2"ì¸ ê²½ìš° */
    thead th[colspan="2"],
    tbody td[colspan="2"] {
      width: 115px !important;
      min-width: 115px !important;
      max-width: 115px !important;
    }
    
    /* ê°•ì œ ë„ˆë¹„ ì ìš©ì„ ìœ„í•œ ì¶”ê°€ ìŠ¤íƒ€ì¼ */
    col:nth-child(1) { width: 30px !important; }
    col:nth-child(2) { width: 85px !important; }
    col:nth-child(3), col:nth-child(4), col:nth-child(5), 
    col:nth-child(6), col:nth-child(7) { width: 160px !important; }
    col:nth-child(8) { width: 30px !important; }
    col:nth-child(9), col:nth-child(10), col:nth-child(11), 
    col:nth-child(12), col:nth-child(13), col:nth-child(14) { width: 160px !important; }
    col:nth-child(15) { width: 30px !important; }
    col:nth-child(16), col:nth-child(17), col:nth-child(18), 
    col:nth-child(19), col:nth-child(20), col:nth-child(21), 
    col:nth-child(22) { width: 160px !important; }
    col:nth-child(23) { width: 40px !important; }
    
    /* ì—´ ë„ˆë¹„ ê³ ì • - ì²« ë²ˆì§¸ì™€ ë‘ ë²ˆì§¸ ì—´ */
    table tbody tr td:first-child,
    table thead tr th:first-child {
      width: 30px !important;
      min-width: 30px !important;
      max-width: 30px !important;
    }
    
    table tbody tr td:nth-child(2),
    table thead tr th:nth-child(2) {
      width: 85px !important;
      min-width: 85px !important;
      max-width: 85px !important;
    }
    
    /* colspan="2"ì¸ ê²½ìš° */
    table tbody tr td[colspan="2"],
    table thead tr th[colspan="2"] {
      width: 115px !important;
      min-width: 115px !important;
      max-width: 115px !important;
    }
    
    /* ëª¨ë“  position ê´€ë ¨ ì…€ */
    .position-cell {
      width: var(--position-width) !important;
      min-width: var(--position-width) !important;
      max-width: var(--position-width) !important;
    }
    
    /* 3ë²ˆì§¸ ì—´ë¶€í„°ëŠ” í°ìƒ‰ ë°°ê²½ - ê³ ì • ì—´ ì œì™¸ */
    tbody td:nth-child(n+3) {
      background-color: white !important;
      position: relative;
      z-index: 1;
    }
    
    /* ê³ ì •ë˜ì§€ ì•Šì€ ì¼ë°˜ ì…€ë“¤ì˜ z-indexë¥¼ ë‚®ê²Œ ì„¤ì • */
    .names-cell, .position-cell {
      position: relative;
      z-index: 1;
    }
    
    /* ì´ë¦„ ì…€ - ë°ì´í„° í–‰ë§Œ í°ìƒ‰ ë°°ê²½ ê°•ì œ */
    .names-cell, td.names-cell {
      text-align: left;
      font-size: 10px;
      line-height: 1.4;
      padding: 6px;
      width: var(--position-width) !important;
      min-width: var(--position-width) !important;
      max-width: var(--position-width) !important;
    }
    
    tbody td.names-cell {
      background-color: white !important;
    }
    
    /* ì†Œê³„ ì…€ - ëª¨ë“  ì†Œê³„ì— ì ìš© */
    .subtotal-cell,
    .subtotal-full,
    .subtotal-part,
    td.subtotal-full,
    td.subtotal-part,
    th.subtotal-full,
    th.subtotal-part {
      width: var(--subtotal-width) !important;
      min-width: var(--subtotal-width) !important;
      max-width: var(--subtotal-width) !important;
      font-size: 11px !important;
      font-weight: bold !important;
      padding: 2px !important;
      text-align: center !important;
      vertical-align: middle !important;
      line-height: 1.2 !important;
      overflow: hidden !important;
      white-space: nowrap !important;
    }
    
    /* í•©ê³„ ì…€ */
    .total-cell,
    .grand-total,
    td.grand-total,
    th.grand-total {
      width: var(--total-width) !important;
      min-width: var(--total-width) !important;
      max-width: var(--total-width) !important;
      font-size: 11px !important;
      font-weight: bold !important;
      padding: 2px !important;
      text-align: center !important;
      vertical-align: middle !important;
      line-height: 1.2 !important;
      overflow: hidden !important;
      white-space: nowrap !important;
    }
    
    /* ê³ ì • ì—´ ê´€ë ¨ ìŠ¤íƒ€ì¼ ì™„ì „ ì¬ì •ë¦¬ */
    /* ê¸°ë³¸ ê³ ì • ì—´ ìŠ¤íƒ€ì¼ */
    .sticky-col-1, .sticky-col-2,
    tbody td:first-child,
    tbody td:nth-child(2),
    thead th:first-child,
    thead th:nth-child(2) {
      position: -webkit-sticky !important;
      position: sticky !important;
      background-clip: padding-box !important;
      isolation: isolate !important;
      transform: translateX(0); /* ìƒˆë¡œìš´ ë ˆì´ì–´ ìƒì„± */
    }
    
    /* ì²« ë²ˆì§¸ ì—´ */
    .sticky-col-1,
    tbody td:first-child,
    thead th:first-child,
    tbody td[colspan="2"] {
      left: 0 !important;
      z-index: 10 !important;
      background-color: #f8f9fa !important;
      border-right: 3px solid #495057 !important;
    }
    
    /* ë‘ ë²ˆì§¸ ì—´ (colspanì´ ì—†ëŠ” ê²½ìš°ë§Œ) */
    .sticky-col-2:not([colspan]),
    tbody td:nth-child(2):not([colspan]),
    thead th:nth-child(2):not([colspan]) {
      left: 30px !important;
      z-index: 9 !important;
      background-color: #f8f9fa !important;
      border-right: 3px solid #495057 !important;
    }
    
    /* í—¤ë”ì˜ ê³ ì • ì—´ */
    thead th:first-child,
    thead th:nth-child(2) {
      z-index: 25 !important;
      background-color: #34495e !important;
      color: white !important;
      top: 0 !important;
    }
    
    /* colspan="2"ì¸ ê²½ìš° íŠ¹ë³„ ì²˜ë¦¬ */
    td[colspan="2"].sticky-col-1 {
      width: 115px !important;
      min-width: 115px !important;
      max-width: 115px !important;
    }
    
    /* í•©ê³„ í–‰ì˜ ê³ ì • ì—´ */
    .total-row td:first-child,
    .total-row td[colspan="2"] {
      z-index: 12 !important;
      border-top: 2px solid #495057 !important;
    }
    
    .subtotal-full, tbody td.subtotal-full {
      background-color: #bbdefb !important;
    }
    
    .subtotal-part, tbody td.subtotal-part {
      background-color: #c8e6c9 !important;
    }
    
    .grand-total, tbody td.grand-total {
      background-color: #ffe082 !important;
    }
    
    /* í—¤ë” ì†Œê³„ */
    thead th.subtotal-full {
      background-color: #bbdefb !important;
    }
    
    thead th.subtotal-part {
      background-color: #c8e6c9 !important;
    }
    
    thead th.grand-total {
      background-color: #ffe082 !important;
    }
    
    .full-time-header {
      background-color: #e3f2fd;
    }
    
    .part-time-header {
      background-color: #e8f5e9;
    }
    
    .total-row {
      background-color: #fff3cd;
      font-weight: bold;
      font-size: 12px;
    }
    
    /* í•©ê³„ í–‰ì˜ ê³ ì • ì—´ ì²˜ë¦¬ */
    .total-row td:first-child,
    .total-row td[colspan="2"] {
      position: -webkit-sticky !important;
      position: sticky !important;
      left: 0 !important;
      z-index: 12 !important;
      background-color: #f8f9fa !important;
      border-right: 2px solid #495057 !important;
    }
    
    /* tbody ìŠ¤íƒ€ì¼ ì¶”ê°€ */
    tbody {
      position: relative;
    }
    
    /* ëª¨ë“  tdì— ê¸°ë³¸ position relative ì ìš© */
    tbody td {
      position: relative;
    }
    
    /* ê³ ì • ì—´ì˜ ì¶”ê°€ ìŠ¤íƒ€ì¼ë§ */
    tbody td.sticky-col-1,
    tbody td.sticky-col-2,
    tbody td:first-child,
    tbody td:nth-child(2):not([colspan]) {
      background-color: #f8f9fa !important;
      border-right-width: 3px !important;
      border-right-style: solid !important;
      border-right-color: #6c757d !important;
      overflow: hidden !important;
      text-overflow: ellipsis !important;
    }
    
    /* ì¼ë°˜ ì…€ë“¤ì˜ z-indexë¥¼ ë‚®ê²Œ ìœ ì§€ */
    tbody td:not(.sticky-col-1):not(.sticky-col-2):not(:first-child):not(:nth-child(2)) {
      z-index: 1;
    }
    
    .total-row td {
      padding: 4px;
      border: 1px solid #dee2e6;
    }
    
    .dept-name {
      white-space: normal;
      text-align: left;
      padding-left: 8px;
      word-break: keep-all;
      line-height: 1.2;
      width: var(--dept-name-width) !important;
      min-width: var(--dept-name-width) !important;
      max-width: var(--dept-name-width) !important;
      font-size: 12px;
      background-color: #f8f9fa;
      font-weight: bold;
      color: #2c3e50;
      border: 1px solid #dee2e6;
    }
    
    /* ë‘ ë²ˆì§¸ ì—´ì˜ dept-nameì€ í•­ìƒ ê³ ì • */
    td.dept-name:nth-child(2) {
      position: -webkit-sticky !important;
      position: sticky !important;
      left: 30px !important;
      z-index: 9 !important;
    }
    
    .loading {
      text-align: center;
      padding: 60px;
      font-size: 20px;
      color: #6c757d;
    }
    
    .loading:before {
      content: "â³ ";
      font-size: 30px;
      display: block;
      margin-bottom: 10px;
    }
    
    .error {
      text-align: center;
      padding: 40px;
      color: #dc3545;
      font-size: 16px;
      background-color: #f8d7da;
      border: 1px solid #f5c2c7;
      border-radius: 4px;
      margin: 20px;
    }
    
    .error:before {
      content: "âš ï¸ ";
      font-size: 24px;
      display: block;
      margin-bottom: 10px;
    }
    
    /* ì¬ì§ ìƒíƒœ í‘œì‹œ - í…ìŠ¤íŠ¸ ìƒ‰ìƒë§Œ ì‚¬ìš© */
    .status-leave {
      color: #0066cc !important;
      font-weight: bold;
    }
    
    .status-research {
      color: #009900 !important;
      font-weight: bold;
    }
    
    .salary-bold {
      font-weight: bold;
    }
    
    .footnote {
      margin-top: 20px;
      margin-bottom: 10px;
      font-size: 12px;
      color: #495057;
      padding: 10px;
      background-color: #f8f9fa;
      border-radius: 4px;
      border-left: 4px solid #dee2e6;
    }
    
    .footnote-header {
      cursor: pointer;
      user-select: none;
      display: flex;
      align-items: center;
      justify-content: space-between;
      font-weight: bold;
    }
    
    .footnote-header:hover {
      color: #0d6efd;
    }
    
    .footnote-content {
      display: none;
      margin-top: 10px;
      line-height: 1.6;
      animation: slideDown 0.3s ease-out;
    }
    
    .footnote-content.show {
      display: block;
    }
    
    @keyframes slideDown {
      from {
        opacity: 0;
        transform: translateY(-10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    .arrow {
      font-size: 12px;
      transition: transform 0.3s;
    }
    
    .arrow.rotated {
      transform: rotate(90deg);
    }
    
    /* ì„ìš© ì¢…ë£Œì¼ ê¸°ë°˜ ìƒ‰ìƒ í´ë˜ìŠ¤ - ë” ë¶€ë“œëŸ¬ìš´ ìƒ‰ìƒ */
    .appointment-urgent { /* 1-3ê°œì›” */
      background-color: #dc3545 !important;
      color: white !important;
    }
    
    .appointment-warning { /* 4-6ê°œì›” */
      background-color: #fd7e14 !important;
      color: white !important;
    }
    
    .appointment-caution { /* 7-9ê°œì›” */
      background-color: #ffc107 !important;
      color: #212529 !important;
    }
    
    .appointment-notice { /* 10-12ê°œì›” */
      background-color: #fff3cd !important;
      color: #212529 !important;
    }
    
    .appointment-safe { /* 12ê°œì›” ì´ìƒ ë˜ëŠ” ì •ë³´ ì—†ìŒ */
      background-color: transparent !important;
      color: #212529 !important;
    }
    
    /* ì •ë…„ ë„ë˜ ì˜ˆì • ìŠ¤íƒ€ì¼ (12ê°œì›” ì´ë‚´) */
    .retirement-upcoming {
      background-color: #d1ecf1 !important;
      color: #0c5460 !important;
    }
    
    .name-badge {
      display: inline-block;
      background-color: #ffffff;
      padding: 2px 6px;
      margin: 1px;
      border-radius: 3px;
      font-size: 10px;
      cursor: pointer;
      border: 1px solid #e0e0e0;
      transition: all 0.2s;
      position: relative;
    }
    
    .name-badge:hover {
      transform: translateY(-1px);
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      background-color: #f8f9fa;
      border-color: #adb5bd;
    }
    
    .name-badge.salary-bold {
      font-weight: bold;
    }
    
    /* ì„ìš© ê¸°ê°„ í‘œì‹œ ìŠ¤íƒ€ì¼ */
    .appointment-info {
      font-size: 8px;
      background-color: #495057;
      color: white;
      padding: 1px 3px;
      border-radius: 2px;
      margin-left: 2px;
      white-space: nowrap;
      font-weight: normal;
    }
    
    .modal {
      display: none;
      position: fixed;
      z-index: 1000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0,0,0,0.4);
    }
    
    .modal-content {
      background-color: #fefefe;
      margin: 10% auto;
      padding: 0;
      border: 1px solid #888;
      width: 80%;
      max-width: 600px;
      border-radius: 8px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.2);
    }
    
    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 20px;
      background-color: #f8f9fa;
      border-bottom: 1px solid #dee2e6;
      border-radius: 8px 8px 0 0;
    }
    
    .modal-header h3 {
      margin: 0;
      font-size: 20px;
      color: #212529;
    }
    
    #modalBody {
      padding: 20px;
    }
    
    .modal-close {
      color: #aaa;
      font-size: 28px;
      font-weight: bold;
      cursor: pointer;
      line-height: 20px;
    }
    
    .modal-close:hover,
    .modal-close:focus {
      color: black;
    }
    
    .modal-list {
      list-style: none;
      padding: 0;
      margin: 0;
    }
    
    .modal-list li {
      padding: 8px 0;
      border-bottom: 1px solid #f0f0f0;
    }
    
    .modal-list li:last-child {
      border-bottom: none;
    }
    
    .modal-list strong {
      display: inline-block;
      width: 120px;
      color: #333;
    }
    
    @media print {
      @page {
        size: A3 landscape;
        margin: 5mm;
      }
      
      body {
        padding: 0;
        background-color: white;
        margin: 0;
      }
      
      .container {
        box-shadow: none;
        padding: 0;
        max-width: 100%;
        margin: 0;
      }
      
      .controls {
        display: none !important;
      }
      
      .footnote {
        display: none !important;
      }
      
      .table-container {
        overflow: visible !important;
        height: auto !important;
        border: none !important;
        padding: 0 !important;
        margin: 0 !important;
      }
      
      table {
        font-size: 7px !important;
        width: 100% !important;
        max-width: 100% !important;
        page-break-inside: avoid;
      }
      
      th, td {
        padding: 2px !important;
        font-size: 7px !important;
        border: 1px solid #666 !important;
      }
      
      .names-cell {
        font-size: 6px !important;
        padding: 1px !important;
      }
      
      .subtotal-cell, .subtotal-full, .subtotal-part {
        font-size: 8px !important;
        width: 20px !important;
        padding: 1px !important;
      }
      
      .total-cell, .grand-total {
        font-size: 8px !important;
        width: 25px !important;
        padding: 1px !important;
      }
      
      .dept-vertical {
        font-size: 8px !important;
        width: 20px !important;
        padding: 2px !important;
      }
      
      .dept-name {
        font-size: 8px !important;
        width: 60px !important;
        padding: 2px !important;
      }
      
      .position-cell {
        width: 120px !important;
        font-size: 7px !important;
      }
      
      /* ìƒ‰ìƒì€ ìœ ì§€í•˜ë˜ ì¸ì‡„ì— ì í•©í•˜ê²Œ ì¡°ì • */
      .appointment-urgent {
        background-color: #ff4757 !important;
        -webkit-print-color-adjust: exact;
        print-color-adjust: exact;
      }
      
      .appointment-warning {
        background-color: #ff7675 !important;
        -webkit-print-color-adjust: exact;
        print-color-adjust: exact;
      }
      
      .appointment-caution {
        background-color: #fdcb6e !important;
        -webkit-print-color-adjust: exact;
        print-color-adjust: exact;
      }
      
      .appointment-notice {
        background-color: #ffeaa7 !important;
        -webkit-print-color-adjust: exact;
        print-color-adjust: exact;
      }
      
      .retirement-upcoming {
        background-color: #c3e6cb !important;
        -webkit-print-color-adjust: exact;
        print-color-adjust: exact;
      }
      
      .status-leave {
        color: #0066cc !important;
        -webkit-print-color-adjust: exact;
        print-color-adjust: exact;
      }
      
      .status-research {
        color: #009900 !important;
        -webkit-print-color-adjust: exact;
        print-color-adjust: exact;
      }
      
      /* ê³ ì • ì—´ ì¸ì‡„ ì‹œ í•´ì œ */
      td:nth-child(1), th:nth-child(1),
      td:nth-child(2), th:nth-child(2) {
        position: static !important;
      }
      
      /* ë°°ì§€ ìŠ¤íƒ€ì¼ ì¡°ì • */
      .name-badge {
        display: inline !important;
        padding: 0 2px !important;
        margin: 0 1px !important;
        font-size: 6px !important;
      }
      
      .appointment-info {
        font-size: 5px !important;
        padding: 0 1px !important;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="controls">
      <div class="controls-left">
        <a href="admin.html" class="btn" style="text-decoration: none; display: inline-block;">ğŸ” ê´€ë¦¬ì</a>
      </div>
      <div class="controls-right">
        <button class="btn" onclick="loadData()">ğŸ”„ ë°ì´í„° ìƒˆë¡œê³ ì¹¨</button>
        <button class="btn" onclick="window.print()">ğŸ–¨ï¸ ì¸ì‡„</button>
      </div>
    </div>
    
    <div id="content">
      <div class="loading">ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>
    </div>
    
    <div class="footnote">
      <div class="footnote-header" onclick="toggleFootnote()">
        <span>ì£¼ì˜ì‚¬í•­</span>
        <span class="arrow">â–¶</span>
      </div>
      <div class="footnote-content" id="footnoteContent">
        â€¢ ì§„í•œ ê¸€ì”¨: ì—°ë´‰ì œ ì „ì„êµì›<br/>
        â€¢ í…ìŠ¤íŠ¸ ìƒ‰ìƒ - <span style="color: #0066cc; font-weight: bold;">íŒŒë€ìƒ‰: íœ´ì§</span>, 
          <span style="color: #009900; font-weight: bold;">ì´ˆë¡ìƒ‰: ì—°êµ¬ë…„</span><br/>
        â€¢ <span class="retirement-upcoming" style="padding: 2px 4px; border-radius: 2px;">ì—°ë‘ìƒ‰ ë°°ê²½</span>: 12ê°œì›” ì´ë‚´ ì •ë…„ ë„ë˜ ì˜ˆì •<br/>
        â€¢ ì„ìš© ì¢…ë£Œì¼ ë°°ê²½ìƒ‰: <span class="appointment-urgent" style="padding: 2px 4px; border-radius: 2px;">ê¸´ê¸‰(1-3ê°œì›”)</span> 
          <span class="appointment-warning" style="padding: 2px 4px; border-radius: 2px;">ì£¼ì˜(4-6ê°œì›”)</span>
          <span class="appointment-caution" style="padding: 2px 4px; border-radius: 2px;">ê´€ì‹¬(7-9ê°œì›”)</span>
          <span class="appointment-notice" style="padding: 2px 4px; border-radius: 2px;">ì–‘í˜¸(10-12ê°œì›”)</span><br/>
        â€¢ ì´ë¦„ ì˜† ìˆ«ì: ì¬ì„ìš©/ì •ë…„ê¹Œì§€ ë‚¨ì€ ê°œì›” ìˆ˜ (12ê°œì›” ì´í•˜ë§Œ í‘œì‹œ)<br/>
        â€¢ ê° êµì›ëª…ì„ í´ë¦­í•˜ë©´ ìƒì„¸ ì •ë³´ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
      </div>
    </div>
  </div>
  
  <!-- ëª¨ë‹¬ -->
  <div id="detailModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3 id="modalTitle"></h3>
        <span class="modal-close" onclick="closeModal()">&times;</span>
      </div>
      <div id="modalBody"></div>
    </div>
  </div>

  <!-- Scripts -->
  <script src="js/config.js"></script>
  <script src="js/api.js"></script>
  <script>
    let globalData = null;
    
    // ì£¼ì˜ì‚¬í•­ í† ê¸€ í•¨ìˆ˜
    function toggleFootnote() {
      const content = document.getElementById('footnoteContent');
      const arrow = document.querySelector('.arrow');
      
      if (content.classList.contains('show')) {
        content.classList.remove('show');
        arrow.classList.remove('rotated');
      } else {
        content.classList.add('show');
        arrow.classList.add('rotated');
      }
    }
    
    // ê³ ì • ì—´ ë¬¸ì œ í•´ê²°ì„ ìœ„í•œ ì¶”ê°€ ì²˜ë¦¬
    function fixStickyColumns() {
      const container = document.querySelector('.table-container');
      if (!container) return;
      
      // ìŠ¤í¬ë¡¤ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
      container.addEventListener('scroll', function() {
        const scrollLeft = this.scrollLeft;
        
        // ì²« ë²ˆì§¸ ì—´ ê³ ì •
        const firstCols = document.querySelectorAll('table tr > *:nth-child(1)');
        firstCols.forEach(col => {
          col.style.transform = `translateX(${scrollLeft}px)`;
        });
        
        // ë‘ ë²ˆì§¸ ì—´ ê³ ì • (colspanì´ ì—†ëŠ” ê²½ìš°)
        const secondCols = document.querySelectorAll('table tr > *:nth-child(2):not([colspan])');
        secondCols.forEach(col => {
          col.style.transform = `translateX(${scrollLeft}px)`;
        });
        
        // colspan="2"ì¸ ì…€ ê³ ì •
        const colspanCols = document.querySelectorAll('table tr > *[colspan="2"]');
        colspanCols.forEach(col => {
          col.style.transform = `translateX(${scrollLeft}px)`;
        });
      });
    }
    
    // í˜ì´ì§€ ë¡œë“œ ì‹œ ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
    window.onload = function() {
      loadData();

      // ê³ ì • ì—´ ë¬¸ì œ í•´ê²° í•¨ìˆ˜ ì‹¤í–‰
      setTimeout(fixStickyColumns, 100);
    };

    // ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
    async function loadData() {
      document.getElementById('content').innerHTML = '<div class="loading">ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>';

      try {
        const response = await api.getFacultyData();
        if (response.success) {
          handleSuccess(response.data);
        } else {
          handleError(response.error || 'ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
        }
      } catch (error) {
        handleError('ì„œë²„ ì—°ê²° ì˜¤ë¥˜: ' + error.message);
      }
    }
    
    // ì„±ê³µ ì²˜ë¦¬
    function handleSuccess(data) {
      console.log('Received data:', data);
      console.log('Data keys:', Object.keys(data));
      globalData = data;
      renderTable();
    }
    
    // ì—ëŸ¬ ì²˜ë¦¬
    function handleError(error) {
      document.getElementById('content').innerHTML = 
        '<div class="error">ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error + '</div>';
    }
    
    // í•™ê³¼ëª… í¬ë§·íŒ… í•¨ìˆ˜
    function formatDeptName(deptName) {
      if (deptName === 'ë¬´ë„ìŠ¤í¬ì¸ ì‚°ì—…í•™ê³¼(ê³„ì•½í•™ê³¼)') {
        return 'ë¬´ë„ìŠ¤í¬ì¸ ì‚°ì—…í•™ê³¼<br/>(ê³„ì•½í•™ê³¼)';
      } else if (deptName === 'ë¯¸ìš©ê²½ì˜í•™ê³¼(ì•¼)') {
        return 'ë¯¸ìš©ê²½ì˜í•™ê³¼<br/>(ì•¼)';
      }
      return deptName;
    }
    
    // ì„ìš© ì¢…ë£Œì¼ê¹Œì§€ì˜ ê°œì›” ìˆ˜ ê³„ì‚°
    function getMonthsUntilEnd(endDate) {
      if (!endDate) return null;
      
      const today = new Date();
      const end = new Date(endDate);
      
      if (isNaN(end.getTime())) return null;
      
      const yearDiff = end.getFullYear() - today.getFullYear();
      const monthDiff = end.getMonth() - today.getMonth();
      const dayDiff = end.getDate() - today.getDate();
      
      let totalMonths = yearDiff * 12 + monthDiff;
      if (dayDiff < 0) totalMonths--;
      
      return Math.max(0, totalMonths);
    }
    
    // ì„ìš© ì¢…ë£Œì¼ ê¸°ë°˜ CSS í´ë˜ìŠ¤ ê²°ì •
    function getAppointmentClass(item) {
      // ëª…ì˜ˆêµìˆ˜ëŠ” ê¸°ë³¸ ìŠ¤íƒ€ì¼
      if (item.position === 'ëª…ì˜ˆêµìˆ˜') {
        return 'appointment-safe';
      }
      
      // ì •ë…„ ë„ë˜ ì˜ˆì •ì ì²´í¬ (12ê°œì›” ì´ë‚´)
      if (item.isRetirementGuaranteed && item.retirementDate) {
        const monthsToRetirement = getMonthsUntilEnd(item.retirementDate);
        if (monthsToRetirement !== null && monthsToRetirement <= 12) {
          return 'retirement-upcoming';
        }
        // ì •ë…„ì´ ë³´ì¥ë˜ì—ˆì§€ë§Œ 12ê°œì›” ì´ìƒ ë‚¨ì€ ê²½ìš°ëŠ” ê¸°ë³¸ ìŠ¤íƒ€ì¼
        return 'appointment-safe';
      }
      
      // ì¼ë°˜ ì„ìš© ì¢…ë£Œì¼ ì²´í¬
      const endDate = item.reappointmentEnd || item.firstAppointmentEnd;
      const months = getMonthsUntilEnd(endDate);
      
      if (months === null || months > 12) return 'appointment-safe';
      if (months <= 3) return 'appointment-urgent';
      if (months <= 6) return 'appointment-warning';
      if (months <= 9) return 'appointment-caution';
      return 'appointment-notice';
    }
    
    // ì´ë¦„ ëª©ë¡ì„ ë²„íŠ¼ í˜•íƒœë¡œ í‘œì‹œí•˜ëŠ” í•¨ìˆ˜
    function formatNames(names) {
      if (!names || names.length === 0) return '';
      
      // ëª¨ë“  ì´ë¦„ì„ ê°œë³„ì ìœ¼ë¡œ ì¶”ì¶œ
      const allNames = [];
      
      names.forEach(item => {
        let nameStr = '';
        let classes = [];
        let originalItem = item;
        
        // ë¬¸ìì—´ì¸ ê²½ìš°
        if (typeof item === 'string') {
          // íŠ¹ìˆ˜ ì²˜ë¦¬: "í™ê¸¸ë™,ê¹€ì² ìˆ˜" ë˜ëŠ” "í™ê¸¸ë™ ê¹€ì² ìˆ˜" í˜•íƒœ ì²˜ë¦¬
          const cleanedStr = item.trim();
          
          // ì‰¼í‘œê°€ ìˆëŠ” ê²½ìš°
          if (cleanedStr.includes(',')) {
            cleanedStr.split(',').forEach(n => {
              const trimmed = n.trim();
              if (trimmed) allNames.push({name: trimmed, classes: [], item: {name: trimmed}});
            });
            return;
          }
          
          // ì‰¼í‘œê°€ ì—†ê³  ê³µë°±ì´ ìˆëŠ” ê²½ìš°
          // ì—°ì†ëœ í•œê¸€ ì´ë¦„ë“¤ì„ ì°¾ê¸° (2-4ê¸€ì)
          const namePattern = /[ê°€-í£]{2,4}/g;
          const foundNames = cleanedStr.match(namePattern);
          
          if (foundNames && foundNames.length > 1) {
            foundNames.forEach(n => allNames.push({name: n, classes: [], item: {name: n}}));
            return;
          }
          
          // ê·¸ ì™¸ì˜ ê²½ìš° ì „ì²´ë¥¼ í•˜ë‚˜ì˜ ì´ë¦„ìœ¼ë¡œ ì²˜ë¦¬
          if (cleanedStr) {
            allNames.push({name: cleanedStr, classes: [], item: {name: cleanedStr}});
          }
        }
        // ê°ì²´ì¸ ê²½ìš°
        else {
          nameStr = item.name;
          
          // ê°ì²´ì˜ nameë„ ì—¬ëŸ¬ ì´ë¦„ì´ í¬í•¨ë˜ì–´ ìˆì„ ìˆ˜ ìˆìŒ
          if (nameStr.includes(',')) {
            nameStr.split(',').forEach(n => {
              const trimmed = n.trim();
              if (trimmed) {
                let formattedName = trimmed;
                const nameClasses = [];
                
                // ì¬ì§ ìƒíƒœëŠ” ë§ˆì§€ë§‰ ì´ë¦„ì—ë§Œ ì¶”ê°€
                if (item.status && nameStr.split(',').indexOf(n) === nameStr.split(',').length - 1) {
                  formattedName += `(${item.status})`;
                }
                
                // ìŠ¤íƒ€ì¼ ì ìš©
                if (item.isSalary) nameClasses.push('salary-bold');
                if (item.status === 'íœ´ì§') nameClasses.push('status-leave');
                else if (item.status === 'ì—°êµ¬') nameClasses.push('status-research');
                
                // ì„ìš© ì¢…ë£Œì¼ ê´€ë ¨ í´ë˜ìŠ¤ ì¶”ê°€
                nameClasses.push(getAppointmentClass(item));
                
                // ê°œì›” ìˆ˜ ê³„ì‚°
                let months = null;
                if (item.position !== 'ëª…ì˜ˆêµìˆ˜') {
                  if (item.isRetirementGuaranteed && item.retirementDate) {
                    months = getMonthsUntilEnd(item.retirementDate);
                  } else {
                    const endDate = item.reappointmentEnd || item.firstAppointmentEnd;
                    months = getMonthsUntilEnd(endDate);
                  }
                }
                
                allNames.push({name: formattedName, classes: nameClasses, item: {...item, serialType: item.serialType}, months: months});
              }
            });
            return;
          }
          
          // ì—°ë´‰ì œ í‘œì‹œ
          if (item.isSalary) {
            classes.push('salary-bold');
          }
          
          // ì¬ì§ ìƒíƒœ í‘œì‹œ
          if (item.status) {
            nameStr += `(${item.status})`;
            if (item.status === 'íœ´ì§') {
              classes.push('status-leave');
            } else if (item.status === 'ì—°êµ¬') {
              classes.push('status-research');
            }
          }
          
          // ì„ìš© ì¢…ë£Œì¼ ê´€ë ¨ í´ë˜ìŠ¤ ì¶”ê°€
          classes.push(getAppointmentClass(item));
          
          // ê°œì›” ìˆ˜ ê³„ì‚°
          let months = null;
          if (item.position !== 'ëª…ì˜ˆêµìˆ˜') {
            if (item.isRetirementGuaranteed && item.retirementDate) {
              const monthsToRetirement = getMonthsUntilEnd(item.retirementDate);
              if (monthsToRetirement !== null && monthsToRetirement <= 12) {
                months = monthsToRetirement;
              }
            } else {
              const endDate = item.reappointmentEnd || item.firstAppointmentEnd;
              months = getMonthsUntilEnd(endDate);
            }
          }
          
          allNames.push({name: nameStr, classes: classes, item: {...item, serialType: item.serialType}, months: months});
        }
      });
      
      // ë²„íŠ¼ í˜•íƒœë¡œ ìƒì„±
      const result = [];
      allNames.forEach((nameObj, i) => {
        const classStr = ['name-badge', ...nameObj.classes].join(' ');
        let appointmentInfo = '';
        
        // ì„ìš© ì¢…ë£Œì¼ ì •ë³´ í‘œì‹œ (ëª…ì˜ˆêµìˆ˜ ì œì™¸, 12ê°œì›” ì´í•˜ë§Œ)
        if (nameObj.months !== null && nameObj.months <= 12) {
          appointmentInfo = `<span class="appointment-info">${nameObj.months}ê°œì›”</span>`;
        }
        
        // ì¬ì§ ìƒíƒœì— ë”°ë¥¸ ìŠ¤íƒ€ì¼ ì ìš©ì„ ìœ„í•œ ì¶”ê°€ ì²˜ë¦¬
        let nameText = nameObj.name;
        if (nameObj.item.status === 'íœ´ì§' && nameText.includes('(íœ´ì§)')) {
          nameText = `<span class="status-leave">${nameText}</span>`;
        } else if (nameObj.item.status === 'ì—°êµ¬' && nameText.includes('(ì—°êµ¬)')) {
          nameText = `<span class="status-research">${nameText}</span>`;
        }
        
        result.push(`<span class="${classStr}" onclick="showFacultyDetail('${encodeURIComponent(JSON.stringify(nameObj.item))}')">${nameText}${appointmentInfo}</span>`);
      });
      
      return result.join(' ');
    }
    
    // ë§Œë‚˜ì´ ê³„ì‚° í•¨ìˆ˜
    function calculateAge(birthDate) {
      if (!birthDate) return null;
      
      const today = new Date();
      const birth = new Date(birthDate);
      
      if (isNaN(birth.getTime())) return null;
      
      let age = today.getFullYear() - birth.getFullYear();
      const monthDiff = today.getMonth() - birth.getMonth();
      
      if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < birth.getDate())) {
        age--;
      }
      
      return age;
    }
    
    // êµì› ìƒì„¸ ì •ë³´ í‘œì‹œ í•¨ìˆ˜
    function showFacultyDetail(encodedData) {
      try {
        const data = JSON.parse(decodeURIComponent(encodedData));
        const modal = document.getElementById('detailModal');
        const modalTitle = document.getElementById('modalTitle');
        const modalBody = document.getElementById('modalBody');
        
        // ì´ë¦„ì—ì„œ ìƒíƒœ ì •ë³´ ì œê±°
        let cleanName = data.name;
        if (data.status) {
          cleanName = cleanName.replace(`(${data.status})`, '').trim();
        }
        
        modalTitle.textContent = `${cleanName} êµì› ì •ë³´`;
        
        // ì„±ë³„ í‘œì‹œ
        let genderText = '';
        if (data.gender) {
          if (data.gender === 'ë‚¨') {
            genderText = '<span style="color: #0d6efd;">ë‚¨ì„±</span>';
          } else if (data.gender === 'ì—¬') {
            genderText = '<span style="color: #d63384;">ì—¬ì„±</span>';
          } else {
            genderText = data.gender;
          }
        } else {
          genderText = '<span style="color: #6c757d;">(ì •ë³´ ì—†ìŒ)</span>';
        }
        
        // ìƒë…„ì›”ì¼ í‘œì‹œ (ë§Œë‚˜ì´ í¬í•¨)
        let birthDateText = '';
        if (data.birthDate) {
          birthDateText = data.birthDate;
          const age = calculateAge(data.birthDate);
          if (age !== null) {
            birthDateText += ` (ë§Œ ${age}ì„¸)`;
          }
        } else {
          birthDateText = '<span style="color: #666;">(ì •ë³´ ì—†ìŒ)</span>';
        }
        
        // ì „ì„êµì›/ë¹„ì „ì„êµì› êµ¬ë¶„
        const fullTimePositions = ['êµìˆ˜', 'ë¶€êµìˆ˜', 'ì¡°êµìˆ˜', 'ë¶€êµìˆ˜(ë¹„ì •ë…„íŠ¸ë™)', 'ì¡°êµìˆ˜(ë¹„ì •ë…„íŠ¸ë™)'];
        const isFullTime = fullTimePositions.includes(data.position);
        
        // ìµœì´ˆ ì„ìš©ì¼ í…ìŠ¤íŠ¸
        let appointmentStartText = '';
        if (data.firstAppointmentStart) {
          if (isFullTime || data.serialType === 'ì „ì„êµì›') {
            appointmentStartText = `<li><strong>ì „ì„êµì› ìµœì´ˆ ì„ìš©ì¼:</strong> ${data.firstAppointmentStart}</li>`;
          } else {
            appointmentStartText = `<li><strong>ìµœì´ˆ ì„ìš© ì‹œì‘ì¼:</strong> ${data.firstAppointmentStart}</li>`;
          }
        }
        
        // ì„ìš© ì¢…ë£Œì¼ í‘œì‹œ
        let appointmentEndText = '';
        
        if (data.position === 'ëª…ì˜ˆêµìˆ˜') {
          // ëª…ì˜ˆêµìˆ˜ëŠ” ì„ìš© ì¢…ë£Œì¼ í‘œì‹œ ì•ˆí•¨
          appointmentEndText = '<span style="color: #6c757d;">(í•´ë‹¹ ì—†ìŒ)</span>';
        } else if (data.isRetirementGuaranteed && data.retirementDate) {
          // ì •ë…„ ë³´ì¥ëœ ê²½ìš° ì •ë…„ì¼ì í‘œì‹œ
          appointmentEndText = data.retirementDate;
          const monthsToRetirement = getMonthsUntilEnd(data.retirementDate);
          
          if (monthsToRetirement !== null) {
            if (monthsToRetirement <= 0) {
              appointmentEndText += ` <span style="color: #dc3545; font-weight: bold;">(ì •ë…„ ë„ë˜)</span>`;
            } else if (monthsToRetirement <= 12) {
              appointmentEndText += ` <span style="color: #28a745; font-weight: bold;">(ì •ë…„ê¹Œì§€ ${monthsToRetirement}ê°œì›”)</span>`;
            } else {
              appointmentEndText += ` <span style="color: #28a745;">(ì •ë…„ ë³´ì¥)</span>`;
            }
          }
        } else {
          // ì¼ë°˜ ì„ìš© ì¢…ë£Œì¼ í‘œì‹œ
          const endDate = data.reappointmentEnd || data.firstAppointmentEnd;
          
          if (endDate) {
            appointmentEndText = endDate;
            const months = getMonthsUntilEnd(endDate);
            
            if (months !== null) {
              if (months <= 0) {
                appointmentEndText += ` <span style="color: #dc3545; font-weight: bold;">(ë§Œë£Œë¨)</span>`;
              } else if (months <= 3) {
                appointmentEndText += ` <span style="color: #dc3545; font-weight: bold;">(${months}ê°œì›” ë‚¨ìŒ - ê¸´ê¸‰)</span>`;
              } else if (months <= 6) {
                appointmentEndText += ` <span style="color: #fd7e14; font-weight: bold;">(${months}ê°œì›” ë‚¨ìŒ - ì£¼ì˜)</span>`;
              } else if (months <= 12) {
                appointmentEndText += ` <span style="color: #ffc107; font-weight: bold;">(${months}ê°œì›” ë‚¨ìŒ)</span>`;
              } else {
                appointmentEndText += ` <span style="color: #28a745;">(${months}ê°œì›” ë‚¨ìŒ)</span>`;
              }
            }
          } else {
            appointmentEndText = '<span style="color: #6c757d;">(ì •ë³´ ì—†ìŒ)</span>';
          }
        }
        
        // ì¬ì§ ìƒíƒœ í…ìŠ¤íŠ¸
        let statusText = '';
        if (data.status) {
          const statusMap = {
            'íœ´ì§': 'íœ´ì§ ì¤‘',
            'ì—°êµ¬': 'ì—°êµ¬ë…„'
          };
          statusText = `<li><strong>ì¬ì§ ìƒíƒœ:</strong> ${statusMap[data.status] || data.status}</li>`;
        }
        
        // ê¸‰ì—¬ì²´ê³„ í…ìŠ¤íŠ¸
        let salaryText = '';
        if (data.serialType === 'ì „ì„êµì›') {
          if (data.isSalary) {
            salaryText = '<li><strong>ê¸‰ì—¬ì²´ê³„:</strong> <span style="color: #0d6efd; font-weight: bold;">ì—°ë´‰ì œ</span></li>';
          } else {
            salaryText = '<li><strong>ê¸‰ì—¬ì²´ê³„:</strong> í˜¸ë´‰ì œ</li>';
          }
        }
        
        // ì†Œì† ì •ë³´
        let deptText = '';
        if (data.college || data.dept) {
          deptText = `<li><strong>ì†Œì†:</strong> ${data.college || ''} ${data.dept || ''}</li>`;
        }
        
        // ì§ê¸‰ ì •ë³´
        let positionText = '';
        if (data.position) {
          positionText = `<li><strong>ì§ê¸‰:</strong> ${data.position}</li>`;
        }
        
        // ì§ë ¬ ì •ë³´ (ê¸°íƒ€ ì§ë ¬ì¸ ê²½ìš°ë§Œ)
        let serialTypeText = '';
        if (data.serialType && !['ì „ì„êµì›', 'ë¹„ì „ì„êµì›', 'ê°ì›êµìˆ˜', 'ê²¸ì„êµì›', 'ì´ˆë¹™êµì›', 'ê°•ì‚¬', 'íŠ¹ì„êµìˆ˜', 'ëª…ì˜ˆêµìˆ˜'].includes(data.serialType)) {
          serialTypeText = `<li><strong>ì§ë ¬:</strong> ${data.serialType}</li>`;
        }
        
        // ì„ìš© ì¢…ë£Œì¼ êµ¬ë¶„ í‘œì‹œ
        let appointmentTypeText = '';
        if (data.position !== 'ëª…ì˜ˆêµìˆ˜' && !data.isRetirementGuaranteed) {
          if (data.reappointmentEnd) {
            appointmentTypeText = '<li><strong>ì„ìš© ì¢…ë¥˜:</strong> ì¬ì„ìš©</li>';
          } else if (data.firstAppointmentEnd) {
            appointmentTypeText = '<li><strong>ì„ìš© ì¢…ë¥˜:</strong> ìµœì´ˆì„ìš©</li>';
          }
        }
        
        // ì„ìš© ì¢…ë£Œì¼ ë¼ë²¨ ê²°ì •
        let appointmentLabel = 'ì„ìš© ì¢…ë£Œì¼:';
        if (data.position === 'ëª…ì˜ˆêµìˆ˜') {
          appointmentLabel = 'ëª…ì˜ˆêµìˆ˜:';
        } else if (data.isRetirementGuaranteed && data.retirementDate) {
          appointmentLabel = 'ì •ë…„ì¼ì:';
        }
        
        modalBody.innerHTML = `
          <ul class="modal-list">
            <li><strong>ì„±ëª…:</strong> ${cleanName}</li>
            <li><strong>ì„±ë³„:</strong> ${genderText}</li>
            <li><strong>ìƒë…„ì›”ì¼:</strong> ${birthDateText}</li>
            ${appointmentStartText}
            <li><strong>${appointmentLabel}</strong> ${appointmentEndText}</li>
            ${appointmentTypeText}
            ${deptText}
            ${positionText}
            ${serialTypeText}
            ${statusText}
            ${salaryText}
          </ul>
        `;
        
        modal.style.display = 'block';
      } catch (error) {
        console.error('Error showing faculty detail:', error);
      }
    }
    
    // ëª¨ë‹¬ ë‹«ê¸° í•¨ìˆ˜
    function closeModal() {
      document.getElementById('detailModal').style.display = 'none';
    }
    
    // ëª¨ë‹¬ ì™¸ë¶€ í´ë¦­ ì‹œ ë‹«ê¸°
    window.onclick = function(event) {
      const modal = document.getElementById('detailModal');
      if (event.target == modal) {
        modal.style.display = 'none';
      }
    }
    
    // í…Œì´ë¸” ë Œë”ë§
    function renderTable() {
      try {
        if (!globalData) {
          handleError('ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.');
          return;
        }

        console.log('Rendering table with globalData:', globalData);
        const currentDate = new Date().toLocaleDateString('ko-KR');
        const { facultyData, deptStructure, fullTimePositions, partTimePositions, otherPositions } = globalData;

        if (!facultyData || !deptStructure) {
          console.error('Missing required data fields:', { facultyData, deptStructure });
          handleError('ë°ì´í„° êµ¬ì¡°ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.');
          return;
        }
      
      let html = `
        <div class="table-container">
          <table>
            <colgroup>
              <col style="width: 30px !important;">
              <col style="width: 85px !important;">
              <col style="width: 160px !important;">
              <col style="width: 160px !important;">
              <col style="width: 160px !important;">
              <col style="width: 160px !important;">
              <col style="width: 160px !important;">
              <col style="width: 30px !important;">
              <col style="width: 160px !important;">
              <col style="width: 160px !important;">
              <col style="width: 160px !important;">
              <col style="width: 160px !important;">
              <col style="width: 160px !important;">
              <col style="width: 160px !important;">
              <col style="width: 30px !important;">
              <col style="width: 160px !important;">
              <col style="width: 160px !important;">
              <col style="width: 160px !important;">
              <col style="width: 160px !important;">
              <col style="width: 160px !important;">
              <col style="width: 160px !important;">
              <col style="width: 160px !important;">
              <col style="width: 40px !important;">
            </colgroup>
            <thead>
              <tr>
                <th colspan="${3 + fullTimePositions.length + partTimePositions.length + otherPositions.length + 3}" style="padding: 15px; font-size: 18px; font-weight: bold; background-color: #2c3e50; color: white; border: none;">
                  êµì›í˜„í™©(${currentDate})
                </th>
              </tr>
              <tr>
                <th rowspan="2" colspan="2" style="background-color: #34495e; color: white; position: sticky; left: 0; z-index: 102;">êµ¬ë¶„</th>
                <th colspan="${fullTimePositions.length + 1}" class="full-time-header">ì „ì„êµì›</th>
                <th colspan="${partTimePositions.length + 1}" class="part-time-header">ë¹„ì „ì„êµì›</th>
                <th colspan="${otherPositions.length}" class="other-header" style="background-color: #ffeaa7;">ê¸°íƒ€</th>
                <th rowspan="2" class="total-cell" style="width: 40px !important; min-width: 40px !important; max-width: 40px !important; font-size: 11px !important; padding: 2px !important; background-color: #34495e; color: white;">í•©ê³„</th>
              </tr>
              <tr>
      `;
      
      // ì „ì„êµì› í—¤ë”
      fullTimePositions.forEach(pos => {
        if (pos.includes('ë¹„ì •ë…„íŠ¸ë™')) {
          const parts = pos.split('(');
          html += `<th class="full-time-header position-cell">${parts[0]}<br/><span style="font-size: 10px;">(${parts[1]}</span></th>`;
        } else {
          html += `<th class="full-time-header position-cell">${pos}</th>`;
        }
      });
      html += '<th class="subtotal-full" style="width: 30px !important; min-width: 30px !important; max-width: 30px !important; font-size: 11px !important; padding: 2px !important;">ì†Œê³„</th>';
      
      // ë¹„ì „ì„êµì› í—¤ë”
      partTimePositions.forEach(pos => {
        html += `<th class="part-time-header position-cell">${pos}</th>`;
      });
      html += '<th class="subtotal-part" style="width: 30px !important; min-width: 30px !important; max-width: 30px !important; font-size: 11px !important; padding: 2px !important;">ì†Œê³„</th>';
      
      // ê¸°íƒ€ ì§ê¸‰ í—¤ë”
      otherPositions.forEach(pos => {
        html += `<th class="other-header position-cell" style="background-color: #fff3e0;">${pos}</th>`;
      });
      
      html += '</tr></thead><tbody>';
      
      // ë°ì´í„° í–‰
      deptStructure.forEach(dept => {
        if (dept.name === 'ëŒ€í•™ì›' || (dept.subDepts && dept.subDepts.length > 0)) {
          // ëŒ€í•™ì›ì´ê±°ë‚˜ í•™ê³¼ê°€ ìˆëŠ” ëŒ€í•™
          
          // ì‹¤ì œ ë°ì´í„°ê°€ ìˆëŠ” í•™ê³¼ë§Œ í•„í„°ë§
          let activeDepts = dept.subDepts;
          if (dept.name !== 'ëŒ€í•™ì›') {
            activeDepts = dept.subDepts.filter(subDept => {
              const deptData = facultyData[dept.name] && facultyData[dept.name][subDept];
              if (!deptData) return false;
              // ìµœì†Œ í•œ ëª…ì´ë¼ë„ ìˆëŠ”ì§€ í™•ì¸
              return Object.values(deptData).some(arr => arr && arr.length > 0);
            });
          }
          
          if (activeDepts.length === 0 && dept.name === 'ëŒ€í•™ì›') {
            activeDepts = dept.subDepts; // ëŒ€í•™ì›ì€ í•­ìƒ í‘œì‹œ
          } else if (activeDepts.length === 0) {
            // í•™ê³¼ê°€ ì—†ìœ¼ë©´ ê±´ë„ˆë›°ê¸°
            return;
          }
          
          activeDepts.forEach((subDept, subIdx) => {
            const deptData = facultyData[dept.name] && facultyData[dept.name][subDept] ? 
                            facultyData[dept.name][subDept] : {};
            const fullTimeTotal = calculateTotal(deptData, fullTimePositions);
            const partTimeTotal = calculateTotal(deptData, partTimePositions);
            const otherTotal = calculateTotal(deptData, otherPositions);
            const grandTotal = fullTimeTotal + partTimeTotal + otherTotal;
            
            html += '<tr>';
            
            if (subIdx === 0) {
              // ì£¼ìš” ëŒ€í•™ë“¤ì€ ì„¸ë¡œë¡œ í‘œì‹œ
              const verticalDepts = ['ëŒ€í•™ì›', 'ë¬´ë„ëŒ€í•™', 'ì²´ìœ¡ê³¼í•™ëŒ€í•™', 'ë¬¸í™”ì˜ˆìˆ ëŒ€í•™', 'ì¸ë¬¸ì‚¬íšŒìœµí•©ëŒ€í•™', 'AIë°”ì´ì˜¤ìœµí•©ëŒ€í•™'];
              if (verticalDepts.includes(dept.name)) {
                html += `<td rowspan="${activeDepts.length}" class="dept-header dept-vertical">${dept.name}</td>`;
              } else {
                html += `<td rowspan="${activeDepts.length}" class="dept-header">${dept.name}</td>`;
              }
            }
            
            html += `<td class="dept-name">${formatDeptName(subDept)}</td>`;
            
            fullTimePositions.forEach(pos => {
              const names = deptData[pos] || [];
              html += `<td class="names-cell position-cell" style="width: 165px !important; background-color: white !important;">${formatNames(names)}</td>`;
            });
            
            html += `<td class="subtotal-full" style="width: 30px !important; font-size: 11px !important; padding: 2px !important;">${fullTimeTotal}</td>`;
            
            partTimePositions.forEach(pos => {
              const names = deptData[pos] || [];
              html += `<td class="names-cell position-cell" style="width: 165px !important; background-color: white !important;">${formatNames(names)}</td>`;
            });
            
            html += `<td class="subtotal-part" style="width: 30px !important; font-size: 11px !important; padding: 2px !important;">${partTimeTotal}</td>`;
            
            // ê¸°íƒ€ ì§ê¸‰ë“¤
            otherPositions.forEach(pos => {
              const names = deptData[pos] || [];
              html += `<td class="names-cell position-cell" style="width: 165px !important; background-color: white !important;">${formatNames(names)}</td>`;
            });
            
            html += `<td class="grand-total" style="width: 40px !important; font-size: 11px !important; padding: 2px !important;">${grandTotal}</td>`;
            html += '</tr>';
          });
        } else {
          // í•™ê³¼ê°€ ì—†ëŠ” ëŒ€í•™/ë¶€ì„œ (ìš©ì˜¤ë¦„ëŒ€í•™, ì‚°í•™í˜‘ë ¥ë‹¨, í‰ê°€ì„±ê³¼ë¶„ì„ì„¼í„°, êµìœ¡í˜ì‹ ì›, íŠ¹ìˆ˜ì²´ìœ¡ì—°êµ¬ì†Œ ë“±)
          const deptData = facultyData[dept.name] || {};
          const fullTimeTotal = calculateTotal(deptData, fullTimePositions);
          const partTimeTotal = calculateTotal(deptData, partTimePositions);
          const otherTotal = calculateTotal(deptData, otherPositions);
          const grandTotal = fullTimeTotal + partTimeTotal + otherTotal;
          
          html += '<tr>';
          html += `<td colspan="2" class="dept-header">${dept.name}</td>`;
          
          fullTimePositions.forEach(pos => {
            const names = deptData[pos] || [];
            html += `<td class="names-cell position-cell" style="width: 165px !important; background-color: white !important;">${formatNames(names)}</td>`;
          });
          
          html += `<td class="subtotal-full" style="width: 30px !important; font-size: 11px !important; padding: 2px !important;">${fullTimeTotal}</td>`;
          
          partTimePositions.forEach(pos => {
            const names = deptData[pos] || [];
            html += `<td class="names-cell position-cell" style="width: 165px !important; background-color: white !important;">${formatNames(names)}</td>`;
          });
          
          html += `<td class="subtotal-part" style="width: 30px !important; font-size: 11px !important; padding: 2px !important;">${partTimeTotal}</td>`;
          
          // ê¸°íƒ€ ì§ê¸‰ë“¤
          otherPositions.forEach(pos => {
            const names = deptData[pos] || [];
            html += `<td class="names-cell position-cell" style="width: 165px !important; background-color: white !important;">${formatNames(names)}</td>`;
          });
          
          html += `<td class="grand-total" style="width: 40px !important; font-size: 11px !important; padding: 2px !important;">${grandTotal}</td>`;
          html += '</tr>';
        }
      });
      
      // ê¸°íƒ€ í–‰ ì¶”ê°€
      const etcData = facultyData['ê¸°íƒ€'] || {};
      const etcFullTimeTotal = calculateTotal(etcData, fullTimePositions);
      const etcPartTimeTotal = calculateTotal(etcData, partTimePositions);
      const etcOtherTotal = calculateTotal(etcData, otherPositions);
      const etcGrandTotal = etcFullTimeTotal + etcPartTimeTotal + etcOtherTotal;
      
      html += '<tr>';
      html += '<td colspan="2" class="dept-header">ê¸°íƒ€</td>';
      
      fullTimePositions.forEach(pos => {
        const names = etcData[pos] || [];
        html += `<td class="names-cell position-cell" style="width: 165px !important; background-color: white !important;">${formatNames(names)}</td>`;
      });
      
      html += `<td class="subtotal-full" style="width: 30px !important; font-size: 11px !important; padding: 2px !important;">${etcFullTimeTotal}</td>`;
      
      partTimePositions.forEach(pos => {
        const names = etcData[pos] || [];
        html += `<td class="names-cell position-cell" style="width: 165px !important; background-color: white !important;">${formatNames(names)}</td>`;
      });
      
      html += `<td class="subtotal-part" style="width: 30px !important; font-size: 11px !important; padding: 2px !important;">${etcPartTimeTotal}</td>`;
      
      // ê¸°íƒ€ ì§ê¸‰ë“¤
      otherPositions.forEach(pos => {
        const names = etcData[pos] || [];
        html += `<td class="names-cell position-cell" style="width: 165px !important; background-color: white !important;">${formatNames(names)}</td>`;
      });
      
      html += `<td class="grand-total" style="width: 40px !important; font-size: 11px !important; padding: 2px !important;">${etcGrandTotal}</td>`;
      html += '</tr>';
      
      // í•©ê³„ í–‰
      html += '<tr class="total-row">';
      html += '<td colspan="2" style="font-size: 13px; font-weight: bold;">í•©ê³„</td>';
      
      let totalFullTime = 0;
      let totalPartTime = 0;
      let totalOther = 0;
      
      fullTimePositions.forEach(pos => {
        const total = calculateColumnTotal(pos);
        totalFullTime += total;
        html += `<td style="width: 165px !important; background-color: #fff3cd !important;">${total}</td>`;
      });
      
      html += `<td class="subtotal-full" style="background-color: #e1ecf4; color: #004085; font-weight: bold; width: 30px !important; font-size: 11px !important; padding: 2px !important;">${totalFullTime}</td>`;
      
      partTimePositions.forEach(pos => {
        const total = calculateColumnTotal(pos);
        totalPartTime += total;
        html += `<td style="width: 165px !important; background-color: #f8f9fa !important;">${total}</td>`;
      });
      
      html += `<td class="subtotal-part" style="background-color: #d4edda; color: #155724; font-weight: bold; width: 30px !important; font-size: 11px !important; padding: 2px !important;">${totalPartTime}</td>`;
      
      // ê¸°íƒ€ ì§ê¸‰ í•©ê³„
      otherPositions.forEach(pos => {
        const total = calculateColumnTotal(pos);
        totalOther += total;
        html += `<td style="width: 165px !important; background-color: #fff3cd !important;">${total}</td>`;
      });
      
      html += `<td class="grand-total" style="background-color: #fff3cd; color: #856404; font-weight: bold; width: 40px !important; font-size: 11px !important; padding: 2px !important;">${totalFullTime + totalPartTime + totalOther}</td>`;
      html += '</tr>';
      
      html += '</tbody></table></div>';
      
      document.getElementById('content').innerHTML = html;
      
      // í…Œì´ë¸” ë Œë”ë§ í›„ ê³ ì • ì—´ ìŠ¤íƒ€ì¼ ê°•ì œ ì ìš©
      setTimeout(() => {
        // ëª¨ë“  ì²« ë²ˆì§¸ ì—´ì— ìŠ¤íƒ€ì¼ ì ìš©
        document.querySelectorAll('table tr > *:first-child').forEach(el => {
          el.style.position = 'sticky';
          el.style.left = '0';
          el.style.zIndex = '10';
          el.style.backgroundColor = '#f8f9fa';
        });
        
        // ëª¨ë“  ë‘ ë²ˆì§¸ ì—´ì— ìŠ¤íƒ€ì¼ ì ìš© (colspanì´ ì—†ëŠ” ê²½ìš°)
        document.querySelectorAll('table tr > *:nth-child(2):not([colspan])').forEach(el => {
          el.style.position = 'sticky';
          el.style.left = '30px';
          el.style.zIndex = '9';
          el.style.backgroundColor = '#f8f9fa';
        });
        
        // colspan="2"ì¸ ì…€ì— ìŠ¤íƒ€ì¼ ì ìš©
        document.querySelectorAll('table tr > *[colspan="2"]').forEach(el => {
          el.style.position = 'sticky';
          el.style.left = '0';
          el.style.zIndex = '11';
          el.style.backgroundColor = '#f8f9fa';
          el.style.width = '115px';
        });
        
        // í—¤ë”ì˜ ê³ ì • ì—´ ìŠ¤íƒ€ì¼
        document.querySelectorAll('thead tr > *:first-child, thead tr > *:nth-child(2), thead tr > *[colspan="2"]').forEach(el => {
          el.style.backgroundColor = '#34495e';
          el.style.color = 'white';
          el.style.zIndex = '150';
        });
      }, 100);
      } catch (error) {
        console.error('Render table error:', error);
        handleError('í…Œì´ë¸” ë Œë”ë§ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message);
      }
    }
    
    // í•©ê³„ ê³„ì‚°
    function calculateTotal(data, positions) {
      if (!data) return 0;
      
      let total = 0;
      positions.forEach(pos => {
        if (data[pos] && Array.isArray(data[pos])) {
          total += data[pos].length;
        }
      });
      return total;
    }
    
    // ì—´ í•©ê³„ ê³„ì‚°
    function calculateColumnTotal(position) {
      const { facultyData, deptStructure } = globalData;
      let total = 0;
      
      deptStructure.forEach(dept => {
        if (dept.name === 'ëŒ€í•™ì›' || (dept.subDepts && dept.subDepts.length > 0)) {
          // ëŒ€í•™ì›ì´ê±°ë‚˜ í•™ê³¼ê°€ ìˆëŠ” ëŒ€í•™
          dept.subDepts.forEach(subDept => {
            if (facultyData[dept.name] && facultyData[dept.name][subDept] && facultyData[dept.name][subDept][position]) {
              total += facultyData[dept.name][subDept][position].length;
            }
          });
        } else {
          // í•™ê³¼ê°€ ì—†ëŠ” ë¶€ì„œ (ìš©ì˜¤ë¦„ëŒ€í•™, ì‚°í•™í˜‘ë ¥ë‹¨, í‰ê°€ì„±ê³¼ë¶„ì„ì„¼í„°, êµìœ¡í˜ì‹ ì›, íŠ¹ìˆ˜ì²´ìœ¡ì—°êµ¬ì†Œ ë“±)
          if (facultyData[dept.name] && facultyData[dept.name][position]) {
            total += facultyData[dept.name][position].length;
          }
        }
      });
      
      // ê¸°íƒ€ í–‰ë„ í¬í•¨
      if (facultyData['ê¸°íƒ€'] && facultyData['ê¸°íƒ€'][position]) {
        total += facultyData['ê¸°íƒ€'][position].length;
      }
      
      return total;
    }
  </script>
</body>
</html>
